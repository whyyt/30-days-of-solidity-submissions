// SPDX-License-Identifier: MIT
pragma solidity ^0.8.19;

import "@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol";
//å¼•å…¥è¿™ä¸ªæ¥å£æ˜¯ä¸ºäº†è®©æˆ‘ä»¬åœ¨åˆçº¦ä¸­è°ƒç”¨ Chainlink çš„é¢„è¨€æœºå‡½æ•°ï¼Œæ¯”å¦‚ .latestRoundData()ã€‚
import "@openzeppelin/contracts/access/Ownable.sol";

contract CropInsurance is Ownable {
    /*æ¥å£æ˜¯ä¸€ä¸ªå¯ä»¥è°ƒç”¨å…¶ä»–åˆçº¦ä¸­å‡½æ•°çš„è¿œç¨‹é¥æ§å™¨ã€‚è¦åœ¨åˆçº¦ A ä¸­è°ƒç”¨å¦ä¸€ä¸ªåˆçº¦ B çš„å‡½æ•°ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹ä¸¤æ­¥æ“ä½œï¼š
     â‘  å®šä¹‰æ¥å£ï¼šæ¥å£å¯ä»¥è‡ªå·±å†™ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ import ä»å¤–éƒ¨æ–‡ä»¶å¯¼å…¥ã€‚
       æ¥å£è¯­æ³•ï¼š
       interface æ¥å£å {
           function å‡½æ•°å1(...) external view returns (...);
           function å‡½æ•°å2(...) external returns (...);
}
       æ³¨æ„ï¼š
        å‡½æ•°åå’Œç›®æ ‡åˆçº¦ä¸­çš„å‡½æ•°åä¸€è‡´ï¼›
        æ¥å£å‡½æ•°å¿…é¡»æ˜¯ externalï¼›
        ä¸å†™å‡½æ•°ä½“ {}ï¼›
        ä¸å…è®¸å£°æ˜çŠ¶æ€å˜é‡ã€æ„é€ å‡½æ•°ã€‚
     â‘¡ ä½¿ç”¨æ¥å£è°ƒç”¨ç›®æ ‡åˆçº¦çš„å‡½æ•°
       function myFunc() public view returns (...) {
          æ¥å£å æ¥å£å˜é‡ = æ¥å£å(ç›®æ ‡åˆçº¦åœ°å€); // ä½¿ç”¨æ¥å£ç±»å‹ï¼ˆï¼‰å°†ç›®æ ‡åˆçº¦åœ°å€å¼ºåˆ¶è½¬æ¢æˆæ¥å£ç±»å‹çš„å˜é‡ï¼ˆåŸæœ¬æ˜¯åœ°å€å˜é‡ï¼‰
          return æ¥å£å˜é‡.å‡½æ•°å(...);          // è°ƒç”¨è¿œç¨‹åˆçº¦çš„å‡½æ•°
        } */
    AggregatorV3Interface private weatherOracle;   //æ¥å…¥çš„æ˜¯â€œå¤©æ°”â€é¢„è¨€æœºåˆçº¦åœ°å€ï¼Œç”¨äºè°ƒç”¨ latestRoundData() è·å–é™é›¨é‡
    AggregatorV3Interface private ethUsdPriceFeed;  //æ¥å…¥çš„æ˜¯â€œETH/USD æ±‡ç‡â€é¢„è¨€æœºåœ°å€ï¼Œç”¨äºè°ƒç”¨ latestRoundData() è·å–ETHä»·æ ¼
    //è¿™ä¸¤ä¸ªåœ°å€éƒ½æ˜¯å¤–éƒ¨å·²éƒ¨ç½²å¥½çš„é¢„è¨€æœºåˆçº¦åœ°å€ï¼Œåœ¨éƒ¨ç½²è‡ªå·±çš„åˆçº¦æ—¶è¦æ‰‹åŠ¨ä¼ å…¥å®ƒä»¬ï¼Œè¿™äº›åœ°å€å¯ä»¥åœ¨ Chainlink å®˜æ–¹æ–‡æ¡£ä¸­æŸ¥åˆ°ã€‚
    //constantæ˜¯å¸¸å€¼
    uint256 public constant RAINFALL_THRESHOLD = 500;  //é™é›¨é‡é˜ˆå€¼ï¼š500 mm
    uint256 public constant INSURANCE_PREMIUM_USD = 10;  //ä¿é™©ä¿è´¹ï¼š10 USD
    uint256 public constant INSURANCE_PAYOUT_USD = 50;   //ç†èµ”é‡‘é¢ï¼š50 USD
    //ä½¿ç”¨æ˜ å°„ç¡®å®šç”¨æˆ·æ˜¯å¦æŠ•ä¿ä»¥åŠç”¨æˆ·ä¸Šä¸€æ¬¡ç†èµ”æ—¶é—´
    mapping(address => bool) public hasInsurance;   //åœ°å€æ˜ å°„æ˜¯å¦å·²è´­ä¹°ä¿é™©
    mapping(address => uint256) public lastClaimTimestamp;  //åœ°å€æ˜ å°„ä¸Šä¸€æ¬¡ç”³è¯·ç†èµ”çš„æ—¶é—´
    //è®°å½•ç‰¹å®šäº‹ä»¶å†™å…¥åŒºå—é“¾çš„æ—¥å¿—ï¼ˆlogï¼‰ä¸­ï¼Œä»¥ä¾¿å‰ç«¯åº”ç”¨æˆ–åŒºå—æµè§ˆå™¨å¯ä»¥ç›‘å¬å®ƒä»¬ã€‚
    event InsurancePurchased(address indexed farmer, uint256 amount);  //è®°å½•ç”¨æˆ·è´­ä¹°ä¿é™©çš„è¡Œä¸ºï¼šè°ä¹°ï¼Ÿä»˜äº†å¤šå°‘é’±    ç”¨é€”ï¼šå‰ç«¯å¯ä»¥ç›‘å¬è¿™ä¸ªäº‹ä»¶æ¥æ›´æ–° UIï¼Œæˆ–åæœŸå®¡è®¡ç”¨æ¥è¿½è¸ªèµ„é‡‘æµã€‚
    event ClaimSubmitted(address indexed farmer);                      //è®°å½•ç”¨æˆ·æäº¤ç†èµ”è¯·æ±‚çš„è¡Œä¸ºï¼šè°æäº¤çš„ï¼Ÿ      ç”¨é€”ï¼šç¡®è®¤è°å‘èµ·äº†è¯·æ±‚ï¼Œé…åˆåç»­é€»è¾‘åˆ¤æ–­è¯¥ç†èµ”æ˜¯å¦æœ‰æ•ˆã€‚
    event ClaimPaid(address indexed farmer, uint256 amount);           //è®°å½•ç”¨æˆ·æˆåŠŸè·å¾—èµ”å¿çš„äº‹ä»¶ï¼šè°è·èµ”ï¼Ÿè·èµ”å¤šå°‘ï¼Ÿ   ç”¨é€”ï¼šå‰ç«¯å¯ä»¥æ®æ­¤æç¤ºâ€œèµ”ä»˜åˆ°è´¦â€ï¼ŒåŒºå—é“¾æµè§ˆå™¨ä¹Ÿèƒ½è®°å½•è¯¥äº¤æ˜“çš„å½±å“ã€‚
    event RainfallChecked(address indexed farmer, uint256 rainfall);   //è®°å½•ç”¨æˆ·æŸ¥è¯¢å¤©æ°”ä¿¡æ¯çš„è¡Œä¸ºï¼šè°æŸ¥ï¼ŸæŸ¥åˆ°é™é›¨é‡æ˜¯å¤šå°‘ï¼Ÿ   ç”¨é€”ï¼šè¿½è¸ªæŸä¸ªåœ°å€åœ¨æŸä¸ªæ—¶é—´ç‚¹çš„å¤©æ°”æ•°æ®ï¼Œç”¨äºå¯è§†åŒ–æˆ–å®¡è®¡ã€‚
    

    /*åˆå§‹åŒ–ï¼šå°†ç›®æ ‡åˆçº¦åœ°å€ï¼ˆå¤©æ°”é¢„è¨€æœºåˆçº¦åœ°å€å’Œæ±‡ç‡é¢„è¨€æœºåœ°å€ï¼‰å¼ºåˆ¶è½¬æ¢æˆæ¥å£ç±»å‹çš„å˜é‡ï¼›
             å°†å½“å‰éƒ¨ç½²åˆçº¦çš„åœ°å€è®¾ä¸ºç®¡ç†è€…*/
    constructor(address _weatherOracle, address _ethUsdPriceFeed) payable Ownable(msg.sender) {  //payableï¼šè¡¨ç¤ºæ„é€ å‡½æ•°å¯ä»¥æ¥æ”¶ETHå¹¶å­˜å…¥å½“å‰åˆçº¦åœ°å€
        weatherOracle = AggregatorV3Interface(_weatherOracle);   //æ¥å£å˜é‡ = æ¥å£å(ç›®æ ‡åˆçº¦åœ°å€);
        ethUsdPriceFeed = AggregatorV3Interface(_ethUsdPriceFeed);
    }
    /*æ‰€æœ‰é€šè¿‡ payable æ”¶åˆ°çš„ ETHï¼Œéƒ½ä¼šè¿›åˆ° address(this) â€”â€”ä¹Ÿå°±æ˜¯åˆçº¦è‡ªå·±çš„è´¦æˆ·é‡Œã€‚
      æ‰€æœ‰ä½ åœ¨ä»£ç é‡Œé€šè¿‡ .call{value: x}() ç­‰è¯­æ³•å‘é€çš„ ETHï¼Œä¹Ÿéƒ½æ˜¯ä» address(this) æ‰£çš„ã€‚
   ğŸ’¡åˆçº¦å°±æ˜¯ä¸€ä¸ªâ€œè´¦æˆ·â€ï¼Œæœ‰è‡ªå·±çš„ä½™é¢ï¼Œæœ‰è‡ªå·±çš„æ”¶ä»˜æ¬¾èƒ½åŠ›ã€‚*/


    //ç”¨æˆ·è°ƒåŠ¨å‡½æ•°è´­ä¹°ä¿é™©
    function purchaseInsurance() external payable {
        uint256 ethPrice = getEthPrice();  //è°ƒç”¨getEthPrice()å‡½æ•°ï¼Œè¿”å›å½“å‰ ETH çš„ç¾å…ƒä»·æ ¼ï¼Œå¹¶å­˜å…¥ethPriceä¸­
        uint256 premiumInEth = (INSURANCE_PREMIUM_USD * 1e18) / ethPrice;//æŠŠä¿è´¹ï¼ˆ10ç¾å…ƒï¼‰æŒ‰å½“å‰ ETH æ±‡ç‡æ¢ç®—æˆåº”ä»˜çš„ ETH é‡‘é¢ï¼ˆå•ä½ weiï¼‰ï¼Œç”¨äºåšæ¯”è¾ƒã€‚
        //NSURANCE_PREMIUM_USDï¼šå›ºå®šä¿è´¹ï¼ˆ10 ç¾å…ƒï¼‰ï¼›1e18ï¼šè¡¨ç¤º 1 ETHï¼›ethPriceï¼šETH çš„å½“å‰ç¾å…ƒä»·æ ¼
        //1e18 æ˜¯ä¸€ç§ç§‘å­¦è®¡æ•°æ³•ï¼Œè¡¨ç¤º1åæœ‰18ä¸ª0ï¼Œå†æ¯”å¦‚2.5e6ï¼Œè¯´æ˜2.5åé¢æœ‰6ä¸ª0
        require(msg.value >= premiumInEth, "Insufficient premium amount"); //æ£€æŸ¥å®é™…ä»˜æ¬¾é‡‘é¢msg.valueæ˜¯å¦ç¬¦åˆåº”ä»˜é‡‘é¢premiumInEth
        require(!hasInsurance[msg.sender], "Already insured");  //æ£€æŸ¥æ˜¯å¦æŠ•è¿‡ä¿äº†ï¼Œä¸å¯ä»¥é‡å¤æŠ•ä¿

        hasInsurance[msg.sender] = true;  //å®ŒæˆæŠ•ä¿
        emit InsurancePurchased(msg.sender, msg.value);  //è§¦å‘æŠ•ä¿æˆåŠŸäº‹ä»¶
    }


    //ç¡®è®¤æ˜¯å¦å…·æœ‰èµ”æ¬¾èµ„æ ¼ï¼šé™é›¨é‡ä½äºé˜ˆå€¼&å·²æŠ•ä¿&ä¸€å¤©å†…åªç”³é¢†ä¸€æ¬¡
    function checkRainfallAndClaim() external {
        require(hasInsurance[msg.sender], "No active insurance");  //æ£€æŸ¥æ˜¯å¦æŠ•ä¿
        require(block.timestamp >= lastClaimTimestamp[msg.sender] + 1 days, "Must wait 24h between claims"); //æ£€æŸ¥ç”¨æˆ·æ˜¯å¦åœ¨ä¸€å¤©ä¹‹å†…é‡å¤ç”³è¯·ç†èµ”ï¼Œé™åˆ¶ä¸€å¤©åªèƒ½ç”³é¢†ä¸€æ¬¡
        //+ 1 daysï¼šSolidity å…è®¸çš„æ—¶é—´å•ä½è¯­æ³•ï¼ˆ1å¤© = 86400ç§’ï¼‰
        
        (//è·å–å¤©æ°”æ•°æ®
            uint80 roundId,  //è¿™ä¸€è½®æ•°æ®çš„ç¼–å·
            int256 rainfall, //è¿™ä¸€è½®çš„é™é›¨é‡ï¼ˆæ ¸å¿ƒæ•°æ®ï¼‰ æ³¨æ„ï¼šrainfall æ˜¯ int256 ç±»å‹ï¼Œç¨åä¼šè½¬æˆ uint256
            ,  //å ä½ï¼Œè¡¨ç¤ºä¸è¦è¿™ä¸ªæ•°æ® (è¿”å›å€¼é‡Œæˆ‘ä»¬å¯ä»¥â€œå¿½ç•¥â€ä¸éœ€è¦çš„å˜é‡ï¼ˆç”¨é€—å·å ä½)
            uint256 updatedAt, //è¿™è½®æ•°æ®çš„æ—¶é—´æˆ³
            uint80 answeredInRound  //æ•°æ®åœ¨å“ªä¸€è½®è¢«ç¡®å®šï¼ˆç”¨äºåˆ¤æ–­æ˜¯å¦è¿‡æœŸï¼‰
        ) = weatherOracle.latestRoundData();//ä½¿ç”¨æ¥å£å‡½æ•°è¿”å›å…ƒç»„å‚æ•°ã€‚weatherOracleï¼šæ¥å£å˜é‡ï¼›latestRoundDataï¼šå‡½æ•°å
     
        require(updatedAt > 0, "Round not complete");  //å¦‚æœæ•°æ®æ—¶é—´æ˜¯ 0ï¼Œè¯´æ˜è¿™è½®æ•°æ®è¿˜æ²¡å‡†å¤‡å¥½ï¼ˆæ¯”å¦‚é¢„è¨€æœºæ²¡æ›´æ–°ï¼‰ï¼Œé‚£å°±ä¸å…è®¸ç»§ç»­ã€‚
        require(answeredInRound >= roundId, "Stale data");  //ç¡®è®¤æ•°æ®æ˜¯â€œæ–°é²œâ€çš„ï¼Œæ²¡è¿‡æœŸ

        uint256 currentRainfall = uint256(rainfall);  //è½¬æ¢å˜é‡ç±»å‹ï¼šæŠŠ int256 è½¬ä¸º uint256ï¼ˆå› ä¸ºä¸èƒ½æœ‰è´Ÿé™é›¨é‡ï¼‰
        emit RainfallChecked(msg.sender, currentRainfall);  //è§¦å‘ç”¨æˆ·æŸ¥è¯¢é™é›¨é‡äº‹ä»¶ï¼Œç”¨äºå‰ç«¯å±•ç¤ºå½“å‰å¤©æ°”æƒ…å†µ
        
        //è¿›å…¥èµ”ä»˜æµç¨‹
        if (currentRainfall < RAINFALL_THRESHOLD) {  //åˆ¤æ–­é™é›¨é‡æ˜¯å¦ä½äºé˜ˆå€¼
            lastClaimTimestamp[msg.sender] = block.timestamp;  //è‹¥ä½äºé˜ˆå€¼ï¼Œå°†å½“å‰æ—¶é—´æˆ³è®°å½•ä¸ºç”¨æˆ·ç”³é¢†æ—¶é—´
            emit ClaimSubmitted(msg.sender);   //è§¦å‘ç”¨æˆ·æäº¤ç†èµ”è¡Œä¸ºäº‹ä»¶
            uint256 ethPrice = getEthPrice();  //è·å–å½“å‰ETHçš„ç¾å…ƒä»·æ ¼ï¼šä¸€ä¸ªä»¥å¤ªå¸ç­‰äºå¤šå°‘ç¾å…ƒ
            uint256 payoutInEth = (INSURANCE_PAYOUT_USD * 1e18) / ethPrice;   //å°†50ç¾å…ƒæ¢ç®—æˆETHé‡‘é¢
            //ä½¿ç”¨.callå‡½æ•°æ”¯ä»˜èµ”æ¬¾
            // msg.sender åœ¨ .call{value: ...} ä¸­ä¸éœ€è¦æ‰‹åŠ¨è½¬æ¢æˆ payableï¼Œå› ä¸º .call æ˜¯ä½çº§è°ƒç”¨ï¼Œå®ƒæ¥å—ä»»æ„åœ°å€ã€‚
            (bool success, ) = msg.sender.call{value: payoutInEth}("");  //ç»™åˆçº¦åœ°å€ç»™ç”¨æˆ·åœ°å€msg.senderæ”¯ä»˜payoutInEthè¿™æ ·æ•°é‡çš„ä»¥å¤ªå¸
            require(success, "Transfer failed");   //é¡»è¿”å›æ”¯ä»˜æ˜¯å¦æˆåŠŸçš„ç­”å¤
            emit ClaimPaid(msg.sender, payoutInEth);  //è‹¥æˆåŠŸï¼Œè§¦å‘ç”¨æˆ·æˆåŠŸè·èµ”äº‹ä»¶
        }
    }


    //ä½¿ç”¨æ¥å£è°ƒç”¨å‡½æ•°è®¡ç®—ä»¥å¤ªå¸çš„ç¾å…ƒä»·æ ¼ï¼šè·å– 1 ä¸ªä»¥å¤ªå¸ï¼ˆETHï¼‰ç›®å‰å€¼å¤šå°‘ç¾å…ƒï¼ˆUSDï¼‰
    //å•ä½æ˜¯ USD Ã— 1e8
    function getEthPrice() public view returns (uint256) {
        (
            ,
            int256 price,  //åªéœ€è·å–ä»·æ ¼ï¼ˆ1ä»¥å¤ªå¸ç­‰äºå¤šå°‘ç¾å…ƒï¼‰ï¼Œè¿™ä¸ªå€¼ä¹‹ååœ¨å…¶å®ƒå‡½æ•°ä¸­èµ‹ç»™ethPrice
            ,
            ,
        ) = ethUsdPriceFeed.latestRoundData();  //æ¥å£å.ç›®æ ‡å‡½æ•°åï¼ˆï¼‰ï¼›

        return uint256(price);  //è¿”å›ä»·æ ¼
    }


    //ä½¿ç”¨æ¥å£è°ƒç”¨å‡½æ•°æŸ¥è¯¢å½“å‰é™é›¨é‡
    function getCurrentRainfall() public view returns (uint256) {
        (
            ,
            int256 rainfall,  //åªéœ€é™é›¨é‡
            ,
            ,
        ) = weatherOracle.latestRoundData();  //æ¥å£å.ç›®æ ‡å‡½æ•°åï¼ˆï¼‰

        return uint256(rainfall); //å°†å˜é‡ç±»å‹å˜æ¢å†è¿”å›é™é›¨é‡æ•°å€¼
    }


    //ç®¡ç†å‘˜å¯¹åˆçº¦åœ°å€çš„ä½™é¢è¿›è¡Œæç°
    function withdraw() external onlyOwner {
        payable(owner()).transfer(address(this).balance);  //ownerï¼ˆï¼‰æ¥è‡ª OpenZeppelin çš„ Ownable åˆçº¦ï¼Œè¡¨ç¤ºå½“å‰åˆçº¦çš„æ‹¥æœ‰è€…åœ°å€ï¼ˆé€šå¸¸æ˜¯éƒ¨ç½²è€…ï¼‰
    }
    /*âš ï¸ å®‰å…¨æé†’ï¼š
    è™½ç„¶è¿™æ®µä»£ç æ²¡é—®é¢˜ï¼Œä½†å®é™…å¼€å‘ä¸­æ›´æ¨èç”¨ call{value: ...} æ¥æ›¿ä»£ .transfer(...)ï¼Œå› ä¸ºï¼š
    transfer ä¼šè‡ªåŠ¨é™„å¸¦ 2300 gas é™åˆ¶ï¼ˆæŸäº›åˆçº¦åœ°å€æ— æ³•æ¥æ”¶ï¼‰
    æ–°çš„ EVM gas è§„åˆ™å¯èƒ½è®© transfer æ›´å®¹æ˜“å¤±è´¥
    ä¸è¿‡æœ¬åˆçº¦ç”¨äºæ•™å­¦å’Œ mock ç¯å¢ƒï¼Œç”¨ .transfer() ä¹Ÿå®Œå…¨æ²¡é—®é¢˜ã€‚*/

    receive() external payable {}
    /*ğŸš¨ å¦‚æœä½ ä¸å†™è¿™ä¸ªå‡½æ•°ä¼šæ€æ ·ï¼Ÿ
        åˆçº¦ä»å¯ä»¥æ¥æ”¶ ETHï¼Œä½†åªèƒ½é€šè¿‡å·²å®šä¹‰çš„ payable å‡½æ•°ã€‚
        å¦‚æœåˆ«äººç›´æ¥è½¬ ETH è€Œä¸æŒ‡å®šå‡½æ•°ï¼Œäº¤æ˜“ä¼šå¤±è´¥ã€‚
        æ‰€ä»¥å†™ä¸Š receive() å‡½æ•°çš„æ„ä¹‰æ˜¯ï¼š
        ç»™åˆçº¦æ·»åŠ ä¸€ä¸ªâ€œé€šç”¨æ”¶æ¬¾å£â€ï¼Œä¸ç®¡æ˜¯è°æ‰“é’±ï¼Œåªè¦ ETH èƒ½è¿›æ¥å°±ä¸æ‹’æ”¶ã€‚
      âš ï¸ æ³¨æ„äº‹é¡¹ï¼š
        receive() å‡½æ•°ä¸èƒ½å¸¦ä»»ä½•å‚æ•°ã€ä¸èƒ½æœ‰è¿”å›å€¼
        ä¸€ä¸ªåˆçº¦åªèƒ½æœ‰ ä¸€ä¸ª receive() å‡½æ•°
        å¦‚æœä½ è¿˜æƒ³å¤„ç†æ¥æ”¶åˆ°çš„é’±ï¼Œå¯ä»¥åœ¨ {} é‡Œé¢å†™é€»è¾‘ä»£ç ï¼ˆæ¯”å¦‚è®°å½•ã€äº‹ä»¶ç­‰ï¼‰
        
        æ€»ç»“ï¼š receive() 	æä¾›ä¸€ä¸ªâ€œé»˜è®¤æ”¶æ¬¾å…¥å£â€ï¼Œå¤„ç†æ²¡æœ‰å‡½æ•°è°ƒç”¨çš„è½¬è´¦
        æ¯”å¦‚æ²¡æœ‰è°ƒç”¨å‡½æ•°ç›´æ¥è½¬è´¦ç»™åˆçº¦åœ°å€çš„ä»£ç ï¼šsend 1 ETH to 0xYourContractAddress*/
    

    //è·å–åˆçº¦åœ°å€çš„ä½™é¢
    function getBalance() public view returns (uint256) {
        return address(this).balance;
    }

}


/*æˆ‘æƒ³é—®ï¼Œåœ¨å…·ä½“åœºæ™¯ä½¿ç”¨ä¸­ä»€ä¹ˆæƒ…å†µä¸‹ä¼šè®©äººä¸è°ƒç”¨ä»»ä½•å‡½æ•°æ¥ç›´æ¥ç»™åˆçº¦åœ°å€è½¬è´¦ï¼Œä»¥è‡³äºåˆçº¦å¼€å‘è€…è¦è€ƒè™‘åˆ°ä½¿ç”¨receiveï¼ˆï¼‰ç¡®ä¿æ”¶è´¦æˆåŠŸï¼Ÿ

ChatGPT è¯´ï¼š
ä½ é—®å¾—éå¸¸åˆ°ä½ï¼ğŸŒŸ
è¿™ä¸ªé—®é¢˜å…¶å®ç›´å‡»äº†åˆçº¦è®¾è®¡ä¸­ä¸€ä¸ªå¸¸è¢«å¿½ç•¥ä½†å¾ˆé‡è¦çš„ç‚¹ï¼š

ğŸ’¡**â€œåœ¨ä»€ä¹ˆå®é™…åœºæ™¯ä¸‹ï¼Œåˆ«äººä¼šä¸ç»™æˆ‘è°ƒç”¨å‡½æ•°ã€è€Œæ˜¯ç›´æ¥ç»™æˆ‘çš„åˆçº¦åœ°å€æ‰“é’±ï¼Ÿâ€**
ğŸ‘‰ è¿™å°±æ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å†™ receive() å‡½æ•°çš„çœŸæ­£åŠ¨å› ã€‚

âœ… ç®€æ´å›ç­”ï¼š
ğŸ“Œä»»ä½•â€œåªå‘é€ ETHï¼Œä¸è°ƒç”¨å‡½æ•°â€çš„åœºæ™¯ï¼Œéƒ½ä¼šè§¦å‘ receive() å‡½æ•°ã€‚
è¿™ç§æƒ…å†µåœ¨å®é™… Web3 ä¸–ç•Œä¸­æ¯”ä½ æƒ³è±¡å¾—è¦å¤šã€‚ä¸‹é¢æˆ‘ä»¬è¯¦ç»†åˆ—å‡ºå‡ ç§å…¸å‹çš„çœŸå®ä½¿ç”¨åœºæ™¯ã€‚

ğŸ”¹ åœºæ™¯ 1ï¼šç”¨æˆ·ç”¨é’±åŒ…ç›´æ¥è½¬è´¦ç»™åˆçº¦
ğŸ’¬ æ¯”å¦‚ï¼šç”¨æˆ·æ‰“å¼€é’±åŒ…ï¼ˆMetaMaskã€Rainbowã€Trust Wallet ç­‰ï¼‰ï¼Œæ‰‹åŠ¨å¡«å†™åˆçº¦åœ°å€ï¼Œè¾“å…¥é‡‘é¢ï¼Œç„¶åç›´æ¥ç‚¹å‡»â€œå‘é€ ETHâ€ã€‚
         ç”¨æˆ·æ²¡æœ‰è°ƒç”¨åˆçº¦çš„å‡½æ•°ï¼Œåªæ˜¯æ‰“é’±ï¼Œåç«¯åˆçº¦æ²¡æœ‰ receive() å‡½æ•°å°±ä¼šæŠ¥é”™

ğŸ”¹ åœºæ™¯ 2ï¼šNFT æˆ– DeFi é¡¹ç›®é‡Œçš„â€œç©ºæŠ•åœ°å€â€æ”¶æ¬¾
           æœ‰äº›é¡¹ç›®ä¼šè®¾ç½®ä¸€ä¸ªåˆçº¦åœ°å€ä¸“é—¨ç”¨æ¥æ”¶ç”¨æˆ·æäº¤çš„ ETHï¼Œç„¶åå†æ‰¹é‡ç©ºæŠ•ã€‚           
           send 0.05 ETH â†’ 0xProjectAirdropAddress // ç”¨æˆ·åªéœ€å°† ETH ç›´æ¥è½¬è¿‡å»ï¼Œä¸éœ€è¦å‡½æ•°è°ƒç”¨
           è¿™ç±»æ”¶æ¬¾åˆçº¦å¿…é¡»æœ‰ receive() æ‰èƒ½æ¥æ”¶ã€‚

ğŸ”¹ åœºæ™¯ 3ï¼šå¤–éƒ¨åˆçº¦è½¬è´¦ï¼ˆæœªè°ƒç”¨å‡½æ•°ï¼‰
           æœ‰æ—¶å…¶ä»–åˆçº¦ä¼šè¿™æ ·ç»™ä½ è½¬è´¦ï¼š
           (bool success, ) = targetContract.call{value: 1 ether}("");
           å¦‚æœ targetContract é‡Œæ²¡æœ‰ receive()ï¼Œè¿™ç¬”è½¬è´¦å°±å¤±è´¥äº†ã€‚

ğŸ”¹ åœºæ™¯ 4ï¼šä½œä¸ºé’±åŒ…ç”¨çš„åˆçº¦ï¼ˆSmart Walletï¼‰
           æ¯”å¦‚ä½ å†™äº†ä¸€ä¸ªâ€œä¸ªäººæ™ºèƒ½é’±åŒ…â€ï¼Œä½ å¸Œæœ›åˆ«äººèƒ½ç›´æ¥å‘ä½ çš„é’±åŒ…åœ°å€æ‰“ ETHï¼Œå“ªæ€•æ²¡è°ƒç”¨å‡½æ•°ã€‚
           è¿™ç±»é’±åŒ…åˆçº¦é€šå¸¸éƒ½å¸¦æœ‰ receive() æ¥ä¿éšœæ”¶æ¬¾èƒ½åŠ›ã€‚

ğŸ”¹ åœºæ™¯ 5ï¼šNFT é“¸é€ åˆçº¦é‡Œç”¨æˆ·è¾“é”™æ•°æ®
           ç”¨æˆ· mint NFT æœ¬åº”è°ƒç”¨ï¼š
           mint{value: 0.08 ether}()
           ä½†ç”¨æˆ·è¯¯æ“ä½œï¼Œç›´æ¥è½¬è´¦åˆ°åˆçº¦åœ°å€ 0.08 ETHã€‚
           âœ… å¦‚æœä½ åˆçº¦é‡Œå†™äº† receive()ï¼Œä½ å¯ä»¥åœ¨ receive() é‡Œè®¾ç½®é€»è¾‘ï¼Œæ¯”å¦‚è‡ªåŠ¨é€€æ¬¾æˆ–æç¤ºä¿¡æ¯ã€‚

ğŸš¨ ä¸å†™ receive() ä¼šæ€æ ·ï¼Ÿ
æƒ…å†µ	                                 ç»“æœ
ç”¨æˆ·ç›´æ¥è½¬è´¦	                          âŒ å¤±è´¥ï¼Œäº¤æ˜“è¢«å›é€€
åˆçº¦è½¬è´¦ç»™ä½ 	                          âŒ å¤±è´¥ï¼Œèµ„é‡‘ä¸¢å¤±æˆ–å›é€€
é’±åŒ…è§†å›¾æ˜¾ç¤ºâ€œæ— æ³•è½¬è´¦åˆ°è¯¥åœ°å€â€	           âŒ ç”¨æˆ·ä½“éªŒå·®ï¼Œå¯èƒ½é€ æˆä¿¡ä»»å±æœº

âœ… æ‰€ä»¥æ€»ç»“ä¸€ä¸‹ä½ çš„é—®é¢˜ï¼š
ğŸ” ä¸ºä»€ä¹ˆéœ€è¦å†™ receive()ï¼Ÿ
å› ä¸ºåœ¨ç°å®ä¸–ç•Œé‡Œï¼Œâ€œç›´æ¥æ‰“é’±åˆ°åˆçº¦åœ°å€â€æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„å¸¸è§æ“ä½œï¼Œè€Œ Solidity é»˜è®¤æ˜¯ä¸å…è®¸è¿™ç§è¡Œä¸ºçš„ï¼Œå¿…é¡»å†™ receive() æ˜¾å¼å…è®¸ã€‚*/
